<!DOCTYPE html>
<html>
<head>
	<title>Map</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
	<style>
		#mapid { height: 500px; }
	</style>
</head>
<body>
	<div id="mapid"></div>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
	<script>
        var cebuCityCoords;
        var cities;
        fetch('http://localhost:8000/coordinates.json')
            .then(response => response.json())
            .then(data => {
                console.log(data);
                cebuCityCoords = data.municipalities.find(m => m.name === 'CebuCity').coordinates;
                cities = data.municipalities
                // Do something with the data
            })
            .then(data => {
    // execute code here
    var mymap = L.map('mapid').setView([10.3157, 123.8854], 11);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
        '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
        'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
      maxZoom: 18,
    }).addTo(mymap);

    for (var i = 0; i < cities.length; i++) {
      var city = cities[i];
      var polygon = L.polygon(city.coordinates, {
        color: 'red',
        fillColor: '#f03',
        fillOpacity: 0.5
      }).addTo(mymap);

      (function(polygon) {
        polygon.on('click', function(e) {
          var colors = ['#8b0000', "#FF0000", '#FFCCCB', '#ffe200', '#bda800', '#525100', '#90ee90', '#66FF33'];
          var currentColor = polygon.options.fillColor;
          var currentIndex = colors.indexOf(currentColor);
          var nextIndex = (currentIndex + 1) % colors.length;
          var nextColor = colors[nextIndex];
          polygon.setStyle({fillColor: nextColor});
        });
      })(polygon);
    }
    })
    .catch(error => console.error(error));
	</script>
</body>
</html>